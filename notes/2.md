# 2. Go quick-start

- comprehensive go program?
- types, variables, funcitons, methods
- goroutines
- generic codes with interfaces
- error handing as normal program logic

one of the purpose of go:

- being able to be productive w/o losing access to the lower-level programmign constructs
- minimum set of
  - keywords
  - built-in functions
  - syntax
- comprehensive standard library
  - mature for real world web and network based programs

- simple program
  - code: [GitHub: chap2 sample](https://github.com/goinaction/code/tree/master/chapter2/sample)
  - how it works:
    - 1. reads text files
    - 2. makes wep calls
    - 3. decodes both XML and JSON into struct type value
    - note: with goroutines

---

## 2.1. Program architecture

- the flow of program architecture

```note

  MAIN GOROUTINE        set of feeds to search (DB)
  (process)              /
                        /             SEARCH GOROUTINES
                       /              (process)
  retrieve feeds -----/ 
        |                    --> interface --> send   --> report
        |                   /    matcher       result     complete
        v                  /                     |           |
  perform search ----------                      |           |
  (goroutine)               - - channel - - - - -            |
        |                 /                                  |
        |                /                                   |
        v               /          TRACK RESULT GOROUTINES   |
  track result --------/--------|  (process)                 |
  (goroutine)         /         v                            v
        |            /       - shutdown <--------------- wait all
        |           /       /
        v          /     channel
  display result <- - - - /
```

### Project structure for the application

```bash
.
└── sample
    ├── main.go           // Programs entry point
    ├── data
    │   └── data.json     // Contains a list of data feeds
    ├── matchers
    │   └── rss.go        // Matcher for searching rss feeds
    └── search
        ├── default.go    // Default matcher for searching data
        ├── feed.go       // Support for reading the json data file
        ├── match.go      // Interface support for using different matchers
        └── search.go     // Main program logic for performing search
```

- `data` directory: JSON docuemnts of data feeds
- `matchers` directory: ccode for the different types of feeds the program supports
- `search` directory: business logic forf using the different matchers to search content
- `sample` directory: the parent, hold `main` that's the entry point

---

## 2.2. Main package

- the program's entry point: `main.go`

```go
package main

import (
  "log"
  "os"

  _ "github.com/goinaction/code/chapter2/sample/matchers"
  "github.com/goinaction/code/chapter2/sample/search"
)

// init is called prior to main.
func init() {
  // Change the device for logging to stdout.
  log.SetOutput(os.Stdout)
}

// main is the entry point for the program.
func main() {
  // Perform the search for the specified term.
  search.Run("president")
}
```

- go program that produces an executable: two features
  - func `main`: must be declared for build tools, it becomes the entry point
  - package `main`: func `main` located here; if not, the build tools won't produce an executable

- every code file in go belongs to a package (no exception for `main.go`)
- all code files in a directory must use the same package name

```go
import (
  _ "github.com/goinaction/code/chapter2/sample/matchers"

  ...
)
```

- `_` allows initialisation from a package to occur, even if you don't directly use any from the package
- in general, if you don't use any, go complier won't let you declare a package to be imported if it's not used
- we need this for now since:
  - `rss.go` in the `matchers` package contains an `init` function to register the RSS matcher for use

in the package `main`, we have `init` function:

```go
// init is called prior to main.
func init() {
  // Change the device for logging to stdout.
  log.SetOutput(os.Stdout)
}
```

- all `init` functions in any code file that are part of the program:
  - will get called before the main function
  - this `init` sets:
    - logger from the standard library to write to the `stdout` device
    - by default, the loggger is set to write to the `stderr` device

in the `main` function:

```go
// main is the entry point for the program.
func main() {
  // Perform the search for the specified term.
  search.Run("president")
}
```

- we see run `Run` that is imported from package `search`
  - this func has core business logic

---

## 2.3. Search poackage

### `search.go`

### `feed.go`

### `match.go/default.go`

---

## 2.4. RSS matcher

---

## 2.5. Summary

---
